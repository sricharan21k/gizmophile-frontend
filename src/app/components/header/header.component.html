<header
  class="flex flex-wrap sm:justify-start sm:flex-nowrap z-50 w-full bg-white/75 py-2 sticky top-0 backdrop-blur-xl backdrop-filter shadow-lg"
>
  <nav
    class="max-w-[85rem] w-full mx-auto px-1 sm:px-4 flex items-center lg:justify-between"
    aria-label="Global"
  >
    <div class="lg:hidden">
      <button
        (click)="toggleSidebar()"
        class="p-2 font-medium text-gray-500 hover:bg-gray-100 rounded-full mx-2"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2.5"
          stroke="currentColor"
          class="size-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3.75 6.75h16.5m-16.5 5.5h16.5m-16.5 5.5h16.5"
          />
        </svg>
      </button>
    </div>
    <div class="me-5 items-center">
      <a
        class="flex-none text-xl font-semibold text-gray-700"
        routerLink="/home"
        >Gizmophile</a
      >
    </div>
    <div
      class="hidden md:flex me-auto flex-row items-center text-base gap-8 justify-end mt-0 ps-5"
    >
      <a
        class="font-medium text-gray-600 hover:text-gray-400"
        routerLink="/product-list/phone"
        routerLinkActive="text-gray-800 border-b-2 border-gray-600"
        >Phone</a
      >
      <a
        class="font-medium text-gray-600 hover:text-gray-400"
        routerLink="/product-list/tablet"
        routerLinkActive="text-gray-800 border-b-2 border-gray-600"
        >Tablet</a
      >
      <a
        class="font-medium text-gray-600 hover:text-gray-400"
        routerLink="/product-list/laptop"
        routerLinkActive="text-gray-800 border-b-2 border-gray-600"
        >Laptop</a
      >
      <a
        class="font-medium text-gray-600 hover:text-gray-400"
        routerLink="/product-list/watch"
        routerLinkActive="text-gray-800 border-b-2 border-gray-600"
        >Watch</a
      >
      <a
        class="font-medium text-gray-600 hover:text-gray-400"
        routerLink="/product-list/audio"
        routerLinkActive="text-gray-800 border-b-2 border-gray-600"
        >Audio</a
      >
    </div>
    <div
      class="hidden sm:flex ms-auto flex-row items-center gap-5 justify-end mt-0 ps-5"
    >
      <a
        routerLink="/home"
        class="p-2 font-medium text-gray-500 hover:bg-gray-100 rounded-full"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
          class="flex-shrink-0 size-5"
        >
          <path
            d="M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.689Z"
          />
          <path
            d="m12 5.432 8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 0 1-.75-.75v-4.5a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75V21a.75.75 0 0 1-.75.75H5.625a1.875 1.875 0 0 1-1.875-1.875v-6.198a2.29 2.29 0 0 0 .091-.086L12 5.432Z"
          />
        </svg>
      </a>
      <button
        (click)="goBack()"
        class="p-2 font-medium text-gray-500 hover:bg-gray-100 rounded-full"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2.5"
          stroke="currentColor"
          class="flex-shrink-0 size-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"
          />
        </svg>
      </button>
      <button
        (click)="goForward()"
        class="p-2 font-medium text-gray-500 hover:bg-gray-100 rounded-full disabled:opacity-50 disabled:pointer-events-none"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2.5"
          stroke="currentColor"
          class="flex-shrink-0 size-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"
          />
        </svg>
      </button>
    </div>
    <div
      class="flex flex-row items-center gap-5 justify-end mt-0 ps-5 ms-auto lg:ms-0"
    >
      <a
        class="gap-3 font-medium text-gray-500 p-2 hover:bg-gray-100 rounded-full hover:cursor-pointer"
        (click)="getData()"
        ><svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2.5"
          stroke="currentColor"
          class="size-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"
          />
        </svg>
      </a>
      <a
        class="relative inline-flex items-center font-medium text-gray-500 p-2 hover:bg-gray-100 rounded-full"
        routerLink="/cart"
        ><svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="2.5"
          stroke="currentColor"
          class="size-5"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"
          />
        </svg>
        <span
          *ngIf="(cartSize | async) !== 0"
          class="inline-flex items-center ms-1 text-xs font-medium text-gray-600 bg-gray-200 rounded-full py-1 px-2"
          >{{ cartSize | async }}</span
        >
      </a>

      <div class="relative">
        <button
          class="font-medium text-gray-500 p-2 hover:bg-gray-100 rounded-full"
          (click)="toggleProfileDropdown()"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2.5"
            stroke="currentColor"
            class="size-5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"
            />
          </svg>
        </button>
        <div
          @fadeInOut
          *ngIf="showProfileDropdown"
          class="absolute w-40 right-0 mt-4 bg-white shadow-md rounded-lg"
        >
          <div *ngIf="!isAuthenticated()">
            <a
              (click)="toggleProfileDropdown()"
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              routerLink="/login"
            >
              Sign in
            </a>
            <a
              (click)="toggleProfileDropdown()"
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              routerLink="/register"
            >
              Sign up
            </a>
          </div>
          <!-- Dropdown content -->
          <div *ngIf="isAuthenticated()">
            <a
              (click)="toggleProfileDropdown()"
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              routerLink="/profile"
            >
              My account
            </a>
            <a
              (click)="toggleProfileDropdown()"
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              routerLink="/profile/addressList"
            >
              Addresses
            </a>
            <a
              (click)="toggleProfileDropdown()"
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              routerLink="/profile/orders"
            >
              Orders
            </a>
            <a
              (click)="toggleProfileDropdown()"
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              routerLink="/profile/reviews"
            >
              Reviews
            </a>
            <a
              (click)="toggleProfileDropdown()"
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              routerLink="/profile/wishlist"
            >
              Wishlist
            </a>
            <a
              class="block px-4 py-2 text-gray-800 hover:bg-gray-100"
              (click)="logout()"
            >
              Sign out
            </a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>

<!-- Sidebar Overlay -->
<div
  class="fixed top-0 left-0 w-full h-full bg-black opacity-60 z-50 md:hidden"
  [ngClass]="{ hidden: !showSidebar }"
  (click)="toggleSidebar()"
></div>

<!-- Sidebar Menu -->
<div
  [ngClass]="{
    'translate-x-0': showSidebar,
    '-translate-x-full': !showSidebar
  }"
  class="bg-white shadow-md w-64 space-y-6 px-2 fixed inset-y-0 left-0 transform -translate-x-full transition duration-200 ease-in-out z-50 md:hidden"
>
  <button (click)="toggleSidebar()" class="p-4">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
      class="h-6 w-6"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M6 18L18 6M6 6l12 12"
      />
    </svg>
  </button>
  <nav>
    <a
      (click)="toggleSidebar()"
      routerLink="/home"
      class="block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-100"
      routerLinkActive="bg-gray-100"
      >Home</a
    >
    <a
      (click)="toggleSidebar()"
      class="block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-100"
      routerLink="/product-list/phone"
      routerLinkActive="bg-gray-100"
      >Phone</a
    >
    <a
      (click)="toggleSidebar()"
      class="block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-100"
      routerLink="/product-list/tablet"
      routerLinkActive="bg-gray-100"
      >Tablet</a
    >
    <a
      (click)="toggleSidebar()"
      class="block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-100"
      routerLink="/product-list/laptop"
      routerLinkActive="bg-gray-100"
      >Laptop</a
    >
    <a
      (click)="toggleSidebar()"
      class="block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-100"
      routerLink="/product-list/watch"
      routerLinkActive="bg-gray-100"
      >Watch</a
    >
    <a
      (click)="toggleSidebar()"
      class="block py-2.5 px-4 rounded transition duration-200 hover:bg-gray-100"
      routerLink="/product-list/audio"
      routerLinkActive="bg-gray-100"
      >Audio</a
    >
  </nav>
</div>

<!-- Search Overlay -->
<div
  class="fixed top-0 left-0 w-full h-full bg-black opacity-60 transition duration-300 ease-in-out z-50"
  [ngClass]="{ hidden: !showSearchOverlay }"
  (click)="toggleSearchOverlay()"
></div>

<!-- Search bar  -->
<div
  [ngClass]="{
    'translate-y-0': showSearchOverlay,
    '-translate-y-full': !showSearchOverlay
  }"
  class="fixed bg-white shadow-md w-full h-full space-y-6 px-2 top-0 transform -translate-y-full transition duration-300 ease-in-out z-50"
>
  <div class="flex flex-row items-center">
    <div class="text-xl font-semibold text-gray-700">Gizmophile</div>
    <button (click)="toggleSearchOverlay()" class="p-4 text-gray-500 ms-auto">
      <svg
        class="flex-shrink-0 size-6"
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M18 6 6 18" />
        <path d="m6 6 12 12" />
      </svg>
    </button>
  </div>
  <div class="">
    <form [formGroup]="searchForm" (ngSubmit)="search()">
      <input
        (input)="filter($event)"
        [formControl]="searchControl"
        type="text"
        class="py-3 px-4 ps-11 mx-auto w-4/5 md:w-3/4 lg:w-3/5 xl:w-1/2 block bg-gray-100 border-transparent rounded-lg text-sm focus:border-gray-500 focus:ring-gray-500"
        placeholder="Search"
        name="search"
      />
    </form>
  </div>
  <div class="w-4/5 md:w-3/4 lg:w-3/5 xl:w-1/2 mx-auto">
    <div *ngIf="!hideTopics" class="flex justify-around">
      <div>
        <div
          class="flex items-center justify-center gap-x-2 text-gray-400 text-center my-2"
        >
          Trending
          <span
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"
              />
            </svg>
          </span>
        </div>

        <a
          (click)="toggleSearchOverlay()"
          class="hover:bg-gray-400"
          *ngFor="let product of items.slice(0, 5)"
          [routerLink]="['/product', product]"
          [queryParams]="{
            color: product,
            variant: (product.variants | keyvalue)[0].key
          }"
        >
          <div class="flex items-center hover:bg-gray-50">
            <img
              class="size-9"
              [src]="'assets/' + (product.colors | keyvalue)[0].value"
              alt=""
            />
            <h3 class="text-gray-500 p-4 font-semibold hover:text-gray-700">
              {{ product.brand }} {{ product.model }}
            </h3>
          </div>
        </a>
      </div>
      <div>
        <div
          class="flex items-center justify-center gap-x-2 text-gray-400 text-center my-2"
        >
          New Launches
          <span
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"
              />
            </svg>
          </span>
        </div>
        <div class="relative p-4">
          <div *ngIf="newLaunches.length">
            <a
              (click)="toggleSearchOverlay()"
              class="hover:bg-gray-400"
              *ngFor="let product of newLaunches"
              [routerLink]="['/product', product.productId]"
              [queryParams]="{
                color: product.colorId,
                variant: product.variantId
              }"
            >
              <div class="flex items-center hover:bg-gray-50 px-4">
                <img class="size-9" [src]="product.imageUrl" alt="" />
                <h3 class="text-gray-500 p-4 font-semibold hover:text-gray-700">
                  {{ product.productName }}
                </h3>
              </div>
            </a>
          </div>
          <div *ngIf="!newLaunches.length" class="absolute top-1/2 start-1/2">
            <div
              class="animate-spin inline-block size-6 border-[3px] border-current border-t-transparent text-gray-600 rounded-full"
              role="status"
              aria-label="loading"
            ></div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="hideTopics" class="relative">
      <h2
        class="flex items-center justify-center gap-x-2 text-gray-400 text-center my-2"
      >
        Found matches
        <span
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="w-6 h-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M7.5 3.75H6A2.25 2.25 0 0 0 3.75 6v1.5M16.5 3.75H18A2.25 2.25 0 0 1 20.25 6v1.5m0 9V18A2.25 2.25 0 0 1 18 20.25h-1.5m-9 0H6A2.25 2.25 0 0 1 3.75 18v-1.5M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
            />
          </svg>
        </span>
      </h2>
      <div
        *ngIf="searchResults.length && showSearchOverlay"
        class="grid grid-cols-2 items-center justify-around"
      >
        <a
          (click)="toggleSearchOverlay()"
          class="col-span-1 mx-auto hover:bg-gray-400"
          *ngFor="let product of searchResults"
          [routerLink]="['/product', product.productId]"
          [queryParams]="{
            color: product.colorId,
            variant: product.variantId
          }"
        >
          <div class="flex items-center hover:bg-gray-50">
            <div class="w-1/4 h-20 p-4">
              <img class="max-h-20" [src]="product.imageUrl" alt="" />
            </div>
            <h3
              class="w-3/4 text-gray-500 p-4 font-semibold hover:text-gray-700"
            >
              {{ product.productName }}
            </h3>
          </div>
        </a>
      </div>
      <div *ngIf="!searchResults.length" class="absolute start-1/2">
        <div
          class="animate-spin inline-block size-6 border-[3px] border-current border-t-transparent text-gray-600 rounded-full"
          role="status"
          aria-label="loading"
        ></div>
      </div>
    </div>
  </div>
</div>
